/** Caravel sea-shell-newt-v1.1.1 - https://github.com/coshx/caravel */
var Caravel;Caravel=function(){function Caravel(name){this.name=name,this.subscribers=[],this.isUsingWKWebView=null!=window.webkit&&null!=window.webkit.messageHandlers&&null!=window.webkit.messageHandlers.caravel}return Caravel["default"]=null,Caravel.buses=[],Caravel.prototype._post=function(eventName,data){var action,body;return action=null,this.isUsingWKWebView?(body={busName:this.name,eventName:eventName,eventData:data},action=function(_this){return function(){return window.webkit.messageHandlers.caravel.postMessage(body)}}(this)):action=function(_this){return function(){var iframe,src;return iframe=document.createElement("iframe"),src="caravel://host.com?busName="+encodeURIComponent(_this.name)+"&eventName="+encodeURIComponent(eventName),null!=data&&(src+=data instanceof Array||data instanceof Object?"&eventData="+encodeURIComponent(JSON.stringify(data)):"&eventData="+encodeURIComponent(data)),iframe.setAttribute("src",src),document.documentElement.appendChild(iframe),iframe.parentNode.removeChild(iframe)}}(this),setTimeout(action,0)},Caravel.prototype.getName=function(){return this.name},Caravel.prototype.post=function(name,data){return this._post(name,data)},Caravel.prototype.register=function(name,callback){return this.subscribers.push({name:name,callback:callback})},Caravel.prototype.raise=function(name,data){var e,i,len,parsedData,ref,results;for(parsedData=null,parsedData=data instanceof Array||data instanceof Object||"string"==typeof data||data instanceof String?data:JSON.parse(data),ref=this.subscribers,results=[],i=0,len=ref.length;len>i;i++)e=ref[i],e.name===name?results.push(e.callback(name,parsedData)):results.push(void 0);return results},Caravel.getDefault=function(){return null==Caravel["default"]&&(Caravel["default"]=new Caravel("default"),Caravel["default"].post("CaravelInit")),Caravel["default"]},Caravel.get=function(name){var b,i,len,ref;for(ref=Caravel.buses,i=0,len=ref.length;len>i;i++)if(b=ref[i],b.getName()===name)return b;return b=new Caravel(name),Caravel.buses.push(b),b.post("CaravelInit"),b},Caravel}();